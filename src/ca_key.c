#include <stdio.h>
#include <memory.h>

#include "ca_key.h"
#include "ca_sha2.h"

//Données d'initialisation NOT pour ne pas reconnaître trop facilement les données (en même temps, c'est PI en hexa...)
unsigned long __CA_Hash_InternalBaseData[1252] = {
0xdbc09577, 0x7a5cf72c, 0xece675d1, 0xfc8f8cbb, 0x5bf6c7dd, 0xd660ce2f, 0xf7d10567, 0x13b19376, 
0xbad7de19, 0xc72fec88, 0x41ab9930, 0xcb16f393, 0x3f53d648, 0x3683af22, 0xc07b2a4a, 0x4ab8f6e8, 
0x6de92a26, 0x768604e4, 0x2ecef459, 0x67204a53, 0xd0028d24, 0x2fe52048, 0x471e5012, 0x95d98169, 
0x45836fba, 0x0ed38066, 0xdb5e66b8, 0x4c6e9308, 0xf7fe0d1d, 0x7a7103e9, 0x9c96df27, 0x8ea8b196, 
0x5ba7015c, 0x0b6cc281, 0xf26a8b70, 0x8d7149a7, 0x8e7432a7, 0x7deab511, 0x84ab5be2, 0x3da5a64a, 
0x63cf2ac6, 0xd50d9fec, 0x3a2e4fdc, 0xd79f7a0f, 0x35be86e7, 0x4724c710, 0x7186234f, 0x9fc5e7f1, 
0x9361f174, 0x4fe175c1, 0x28ea883e, 0x42ceb4d8, 0x8750d025, 0xaa9fa39f, 0x19aada0c, 0x55aa546b, 
0xa8b7679d, 0x9c17ebbf, 0xaa35c695, 0xd554ef49, 0x4b33a3cb, 0xeebe1731, 0x5eab7950, 0x838d166c, 
0x4c11ebee, 0x9c9043d5, 0xd4563aa2, 0x8be7ce09, 0x31a3c1e9, 0x64786ce1, 0x502945cc, 0x93db30a3, 
0x85cdac7e, 0xd76a7988, 0xc470b767, 0x94b44650, 0x3b4017e4, 0x99d7de6c, 0x9e27f633, 0x04de566e, 
0xb783539f, 0xa2137fcd, 0x107ba2a2, 0x167a8a4e, 0x23d9dcfd, 0x149ae477, 0xdc76c17e, 0x2c69533a, 
0xf092900c, 0x7c0bbdc6, 0xd1f4bb7d, 0x5b7bdffb, 0x96370fb5, 0x61e064a1, 0xde3997bd, 0x09169365, 
0x98f3639e, 0x542c770f, 0x95ae5f2d, 0x27abd097, 0x69f058d7, 0x54aecc5c, 0x9110f493, 0xec85c41b, 
0x45c40faf, 0x8104d567, 0x5e0e9ae2, 0xc650fe89, 0x9935a6c1, 0x7dbcf177, 0x731179e6, 0xba90604b, 
0x827b5a3c, 0xc474a141, 0x1f908a27, 0x7a3edf8c, 0xbfe5bb60, 0xa93e9559, 0xb12c559d, 0xc9c088f9, 
0xe401208d, 0xbd64fdc2, 0xc82f28db, 0x2ff5edb7, 0x24f0152c, 0xb60e3f64, 0xf8ac8d36, 0x7f66e484, 
0xda2b8627, 0x09172108, 0x1c01afe5, 0x4986b3c4, 0x68931f42, 0xfb3ff945, 0x3e56b049, 0xbf609f3b, 
0xa1a3613d, 0xe695db9c, 0x97049050, 0xc193ac4a, 0xecc64d14, 0xc4ad1390, 0x9203aee0, 0x64cf6ad3, 
0x337ebabb, 0x50a142f6, 0x411c2ffb, 0x21ccb502, 0x99f0d7f8, 0xe6d1b44c, 0x3f3457a8, 0xba378bf0, 
0x2df4a0c6, 0x462c0424, 0xaa863f42, 0xe59fcdf5, 0x295eff39, 0xbfd38d86, 0x9860da01, 0x04e05c33, 
0x715a1607, 0x24cddd07, 0xc38ae920, 0x029e94ea, 0xd0afe137, 0x52faad54, 0xcdc24a05, 0x02dc789f, 
0xacce84b7, 0xc1ff207d, 0x61a3a844, 0x3590735f, 0xe578a9d1, 0x20e89624, 0x2abd5709, 0xd781003c, 
0x5398cd39, 0x73b0aa8c, 0x96a4d84f, 0x4435a737, 0x1e005ca2, 0x470fee5f, 0xef05c267, 0x02de7c47, 
0xb5034a93, 0xd22e2ca4, 0x65ac1b86, 0x4907ba9a, 0x2d71b643, 0xb404686f, 0x1e220d25, 0x5b3481cc, 
0x9d04ecbe, 0x311b3917, 0x10df3525, 0xc988b3fe, 0x2f816101, 0xd40ee04b, 0x6a2425b2, 0x516f6e67, 
0x1552718e, 0x946c2a5f, 0x2f712e2f, 0x5038da1f, 0x71c3a4d0, 0x718a6b48, 0x70091d04, 0x0dedd49b, 
0x777747ed, 0x6ff20fe3, 0xb052a15f, 0x97703ce3, 0x2e300e6e, 0x4c573e52, 0xd0d0dde7, 0x41f1e888, 
0x158ad201, 0x74fde05e, 0x1a5f33f0, 0x4a908b17, 0xe7530c29, 0x31761d66, 0x4b57b01f, 0x02ec1f48, 
0x833bc47e, 0x2d525726, 0xe9a05d99, 0x7f6a88fa, 0x6c338ceb, 0xdee5eb88, 0x1952df9a, 0x884a0579, 
0x38abbd0a, 0x0462ca30, 0x143250f3, 0x84c1765f, 0x29bee42c, 0x51e181b6, 0xffdaf1d2, 0xdf8e4ca1, 
0xdd97ff44, 0xa8471f50, 0xdb9bc964, 0x0ff646e1, 0xaa9c6ee2, 0xa6205955, 0x873ebc76, 0x26a5ac80, 
0xdf82a45d, 0xfd1a463a, 0x7cd9fc89, 0x9d6a3056, 0xee37e697, 0xb18cb5be, 0x4cb8d235, 0x84eb56b5, 
0xe4aeffad, 0x65acd6ea, 0x29f0a8c0, 0x4364391b, 0xd49f5b89, 0x7e198bff, 0xf745904a, 0xa8e416e0, 
0x0d691394, 0xd5f226ea, 0x499c9ade, 0x18460649, 0x00cbfad1, 0x3a7aa99b, 0xac4fd2a2, 0x5660705e, 
0xf745b866, 0x917af895, 0xb4858f16, 0x4a4cd6bb, 0x248af6d1, 0x3be6d9dc, 0x5291594f, 0xb6582082, 
0x63119f47, 0x70124d99, 0x1355738e, 0x9665e800, 0xa99bad93, 0x3d4e611e, 0xe6c9fd5a, 0x8af6b3d6, 
0x5fa6ecbf, 0x1be7c5c1, 0xc0ab6765, 0xa4bd629a, 0x94701b29, 0x6608c029, 0x5e2d63f8, 0x1017cf0a, 
0xb2d2c719, 0x0fdaa23e, 0xb322df79, 0x7b8f14d9, 0x9c7d1639, 0xfde133a1, 0xf69794c0, 0xc1451036, 
0xc368e7eb, 0x94958f5e, 0x9780ca7b, 0xad5f1d79, 0x4863acfa, 0x55aff8c8, 0xc1f87be3, 0x802151a3, 
0x7182bb13, 0xa8e90d47, 0x4fc525c8, 0x0faff3f2, 0x0fe3e0fb, 0xfdff4c00, 0x51f30ae5, 0xc34a8b4d, 
0xda7c85a7, 0x23f6de42, 0x2e6eec06, 0x8356d009, 0x6bcdb88c, 0xdd0ab8fe, 0xc51a1a7e, 0xc83d2523, 
0x374a89cb, 0x650c2258, 0x56bb9eb9, 0xf02ffcf1, 0x133738c1, 0x5b8ae1be, 0x1dc73266, 0xc415f1d0, 
0xcd7f445e, 0xe7c14cce, 0xb1ab74c7, 0xb09246f7, 0x90bdf2fc, 0x09f5fb40, 0xd347ed6f, 0xdb688386, 
0xa9864f8d, 0x43507650, 0x216588e0, 0x266cf7ef, 0x4c7451ed, 0x2330c0d1, 0xaaed8de0, 0xd1948edb, 
0xafe52219, 0x607b3278, 0x85a7b8e7, 0x8bf725e8, 0x43606543, 0x16b48273, 0x138513c5, 0x247ae205, 
0x9cf6bc99, 0x3b9b3c2d, 0x10e3e7b8, 0xcdea26f7, 0x22bcc4c8, 0xdb3d45e9, 0xed5eb2bc, 0xd59a3bae, 
0xaf6bfffd, 0xecc51b22, 0x8e200761, 0xefceb1aa, 0x7e538829, 0xa0eee664, 0xfbcaa90e, 0x285c3894, 
0xc3eee7c4, 0xa6db5af6, 0x0d701912, 0x680e0405, 0x614540d3, 0xe1eac391, 0x791cba8f, 0x1516904e, 
0x79f1a1f5, 0xa5c1d54c, 0x88e018e3, 0xb1c2f905, 0xd69a2346, 0x6618e2f0, 0x7fc17629, 0xad9937da, 
0xd1b33687, 0x63ef4c95, 0x39eaf145, 0x6b1d1587, 0x5a03c3ac, 0xe1f5d20b, 0x0d08b158, 0xc9e2d4c2, 
0xe6c6d9f0, 0xe63d869f, 0xaddc58f7, 0x08eced49, 0x14520191, 0x153ce099, 0x1c43ba6a, 0x5984377c, 
0x4e80c82e, 0xfe7300d7, 0x3ccd2210, 0x4193a55a, 0x9aa7de7a, 0x975467fd, 0x11315af0, 0x24d06ac4, 
0xd5108252, 0xa491d07b, 0xeade49d7, 0xd6f89e8f, 0x1322b88a, 0x9e60eaef, 0xec3357cf, 0x149e4269, 
0xfccb01e1, 0x55fc9c30, 0x4a8ca36f, 0xb38f5dc6, 0x2a6161f4, 0x345521eb, 0x11337943, 0x9f9dd358, 
0x6354a354, 0x4d0c7b91, 0x9b74e150, 0xe6420f35, 0x5fdc9646, 0x9aa544af, 0xbf97a5cd, 0xc3d54b4c, 
0xce61162a, 0x3fde4708, 0x64abf4e6, 0x78a05f66, 0x6a086681, 0x9dc28257, 0x07c87765, 0x681cd288, 
0xee126ca0, 0xe997ed7e, 0xf1ca77d6, 0x3819e029, 0x6921205e, 0x87a74566, 0xa80a7b5a, 0xe4dd8d9c, 
0x647c3c00, 0xe53db969, 0x324cf514, 0xacd1cfab, 0x7026b71b, 0x9243ced7, 0xa7140d10, 0xcb390015, 
0x01d7129e, 0x1183c38c, 0xa2b5eb26, 0x179b481c, 0xbdefa2eb, 0xdfc1ec1f, 0xba111d49, 0x5c555415, 
0x2493b0ea, 0x0534b02f, 0x38bd0bbd, 0x1095444a, 0x9ab0c4e2, 0xbe32defa, 0x27e18661, 0x797ab238, 
0x1bb4b895, 0xc27e9daf, 0x309d5e0d, 0xa472d9b9, 0x03777c5f, 0x3e38495c, 0x80eadb3c, 0x96348b6d, 
0xb87b75f4, 0xa96d4d7a, 0xf6a440ff, 0x52e6b762, 0xeb9d4e8b, 0xdc7df1ff, 0xa7bd72d5, 0xf3aa0a15, 
0xe2520bc1, 0xdcc08f9e, 0xcc8d0f6d, 0x726c81be, 0x29a0130e, 0x93ddc424, 0x8321c8a6, 0x34118b9f, 
0xbf7a0d58, 0x3188cd91, 0x59f87f7b, 0xe607af61, 0x171027aa, 0x9e2668ca, 0x56965855, 0x3af3f93d, 
0xa5fb5403, 0x7ff43523, 0x61bb85d1, 0x3cbacb7b, 0x022a98fa, 0xf1e16136, 0x248c242c, 0xefaa7732, 
0x98a02586, 0x1c98bcbf, 0x3a3bcb9a, 0x8ec1c727, 0xc2d70761, 0x0e9200df, 0xeac1de18, 0x704fc2b5, 
0x191c60d4, 0x247c5208, 0x16c2a597, 0x6b7ebf08, 0x09b3d9e3, 0x6b96d6cb, 0xbeeadf08, 0x89fd2b08, 
0x430b94d1, 0x2b5dff97, 0x2bf7db8e, 0xccdf0b95, 0xbc482b48, 0xafff9e50, 0xe1c609d1, 0x68dbbab9, 
0xebdeb08b, 0x407477bf, 0xb26a03e2, 0x694a6e50, 0x8f0b222c, 0x995fd0ba, 0x4043f613, 0xfc42687a, 
0x8053922f, 0xce347afb, 0x6914d84c, 0xaa02c6be, 0x25dab819, 0x5435f565, 0xd7af87da, 0xacfbd60b, 
0xf5d37925, 0x16499204, 0x9723eb9d, 0x28b796ff, 0x97f13f5b, 0xd85e7211, 0xb0c0015d, 0x17785273, 
0x4a731ff9, 0x850b2949, 0x5531e183, 0x2cc8a013, 0x31875c66, 0xbf94d5bd, 0xdf0161ca, 0x260c7a46, 
0x11c62854, 0xc4edb174, 0xe2360508, 0xb492e7a9, 0xd95c99ce, 0x151c684d, 0xc591058b, 0x22a4bccd, 
0x97be1808, 0x3587df04, 0x04f50ab1, 0x27014c68, 0xbabfa953, 0x45b76ad8, 0xaaacc5c5, 0xdf7c7278, 
0x01945648, 0x2f696ab4, 0xaa579843, 0x5eea65a7, 0x3356d69c, 0x661e24cc, 0x59d5b5a9, 0xc0ceda06, 
0xa10b81e3, 0x6fd6ce83, 0x020717fd, 0xfbd8d08f, 0x7f44eaa3, 0xfad7d31c, 0x6a3eeab7, 0x1b3992dd, 
0xb73eecc0, 0x38f07923, 0xf8063611, 0xbefbe0f0, 0xbfb8865b, 0xa27791e8, 0xcda0ae14, 0x2a643f2e, 
0x0d433e70, 0xbeeeca9b, 0xda8487cb, 0x9fd5639f, 0x2007175c, 0xe09c93e4, 0xf1ed4b3d, 0xfd1ecd61, 
0x5099b02e, 0x352e7eea, 0x94dc6a1f, 0xccc16d1e, 0xc4dbf49d, 0x114146dd, 0x7a4d5df1, 0x1945f266, 
0x218df373, 0xd25d08d7, 0x2fed87ba, 0x6a486b02, 0x9b82f79d, 0x18330a0f, 0xabb65c90, 0x7882b705, 
0x3c6202d8, 0x0cc172e1, 0xf5b89cbe, 0x66d1008b, 0xc5909154, 0x0b0702c8, 0x57ed239f, 0x5e142207, 
0x66e41eb3, 0x249194f2, 0x3984aaef, 0x9298d3c8, 0xd89a2bc4, 0x232f17fb, 0x0ed6f238, 0x33ff005c, 
0x4ac6f06d, 0x96f012f4, 0x99846004, 0x31248263, 0x5f6e30f4, 0x26eaa15c, 0x44ecd077, 0xaea452db, 
0x846b8640, 0x89c42914, 0xc8c6d14c, 0x33eea686, 0x7fd91d68, 0x0bd1ced2, 0x97bd5258, 0x3995d4c4, 
0xed8ab333, 0x87d10ee3, 0x95edbdc8, 0x486dae18, 0xf95e4419, 0xb4049caf, 0xe594efe7, 0xee351205, 
0xc2da4227, 0x1d1e3c36, 0xbbbde9a6, 0xf5edec79, 0x26f31391, 0x2a5415d5, 0x9b5098b1, 0x257957a0, 
0x41401677, 0x9b1b3c01, 0x62437fa8, 0x0f083f79, 0x9f878407, 0x9ffc9fb2, 0x2e027cb9, 0x09c7e04f, 
0x88ba51fb, 0x28c90333, 0x7cbd94cc, 0x0fe1548e, 0x4f7fbe78, 0xc3ffa1a0, 0x885fa841, 0x421751db, 
0xaab9bd66, 0x40a7d19e, 0xb1a70b70, 0x0d22025d, 0x0b8b10c7, 0x7876423d, 0xac99063c, 0x374c718b, 
0x4b8a0daa, 0xb9032646, 0x8514d99e, 0x74e2207b, 0x7b95f186, 0x6ea06a1d, 0xb991a671, 0xdf4ba88f, 
0x732aaa6e, 0x36fd21b3, 0x46f4531e, 0x447dfa2f, 0xee579db7, 0x8a8b5661, 0x4880e649, 0x1f5623f6, 
0x99d2f65e, 0x3bcdb9cc, 0x17a5e0fd, 0xf60f4173, 0xb5665fda, 0xe29101ef, 0xe546c2e2, 0xf45a5b20, 
0x5e790df0, 0xd7970e96, 0x2348257c, 0xa8c6f901, 0x5e1d3164, 0xb03280ad, 0xafeea1fe, 0x58f97c05, 
0x5ffd4a3b, 0xf2192fd8, 0x650773d8, 0x88c079be, 0x3c9fb3f9, 0x9e57f94a, 0x0fe885d7, 0x3f0a791f, 
0xff9fa755, 0xcf23829d, 0xee196128, 0xdcc7159c, 0xac3d226b, 0x3d3de9cb, 0x443411a9, 0x6f434921, 
0x1403825e, 0x31a6e289, 0x90fa1bf6, 0xb483fe77, 0xc68df5c2, 0x836d83db, 0x791c8da0, 0x8db26246, 
0xe53ea44b, 0x2c614703, 0x12abaa87, 0xf7035a4a, 0x27c2832c, 0xb252f03b, 0xe1af10a1, 0x4e9e1907, 
0x5d7aeb26, 0x93aeecc3, 0x902a3818, 0xa91eb13b, 0xc9d54031, 0x223937c8, 0x2865cdcb, 0x6d9c7ded, 
0x98f10571, 0xbf9fff1f, 0xc5c631c8, 0x2c050a30, 0x543d88c8, 0xa53ad2e4, 0xa34f9861, 0xb05cc8bd, 
0x2c7dd8bf, 0x66436441, 0x2aee7162, 0x40f08cea, 0x29d2e381, 0x38ff3b84, 0x4873e494, 0xde5e6fba, 
0x4d914e41, 0x95c9914b, 0xa8b754d0, 0x436b9186, 0x395c892d, 0x9ab63d37, 0xacf00711, 0xb9722182, 
0x2a8cf5e2, 0xb32fb239, 0xd6c64424, 0x5645b9af, 0x536ad917, 0x41a11cfb, 0x5e052a0f, 0x95d2ae65, 
0x9c10731d, 0x657911dd, 0x3f763d47, 0xbcdbd109, 0x5ae1fc55, 0x630d2f5b, 0x7c3f9e45, 0x641695b2, 
0x701aeaaf, 0x459ba429, 0xd7d95d06, 0x58c5c51e, 0xb4566a79, 0x10aa9d16, 0x38d0102c, 0x08ad0825, 
0xc0fb9096, 0x8805f5a6, 0x7f1b56ea, 0x784f79fe, 0x64f61952, 0xc4c11a6c, 0x166f02a5, 0x61cb2868, 
0xd30f4826, 0xfdd474ae, 0x692a53c5, 0xfe825982, 0x2e30c129, 0x8382d2d7, 0xe060da30, 0x520d4764, 
0xa5294b8d, 0xa5770ab3, 0x1fd6538e, 0x1fe65a19, 0xb84f5302, 0x126c0564, 0x172c3b72, 0xd7c4a833, 
0x072a99d6, 0x86ecd1d7, 0x87a0fe6e, 0x128a9faa, 0x0869f1bb, 0x1c2ca173, 0xeafa922b, 0x770b9245, 
0xfc5e9eda, 0xfa9b0f42, 0x3c1461ea, 0xc36fa85d, 0x68d8e513, 0x56c5f8d5, 0xe4c09264, 0xe19cde0a, 
0x0a639904, 0xd9230ce6, 0x8acc26d7, 0x4eaa020a, 0xfca9cb7d, 0x7545c344, 0xd7ae88ee, 0x3df52607, 
0x5433ae98, 0x33526da0, 0xb217e8ae, 0xc7cf2371, 0xc862a79d, 0x6cdf066e, 0x15856f3d, 0x04c18431, 
0xaede319b, 0x88b041cd, 0x57491c81, 0x3cd6c2b9, 0xb721ac96, 0x9bec197f, 0x5d51f7ef, 0x22924ddb, 
0x967ad202, 0xf6f8de99, 0x4c65b9f5, 0x9bba3f22, 0xa7932130, 0xe3df3751, 0xa4410822, 0xe4a772bf, 
0x332dfe80, 0x944b1c44, 0x225d9581, 0xc5a600ba, 0xc1caf5bb, 0x434b322a, 0x8d153157, 0x059b7b44, 
0x7299ed51, 0x40c390b8, 0x2d641b9c, 0xabd0a261, 0x513d88e4, 0x09b19c8f, 0x8bf1f272, 0x18a4eca8, 
0x078de98e, 0x50ac82a2, 0xbfbf34f7, 0xb14b1d33, 0xcb2db995, 0xfeea507b, 0x1e4ffbd7, 0x6a67c5e2, 
0xf947604b, 0x31915fb7, 0x90c0c47d, 0xcadf547d, 0xfee5e2b4, 0xd88dd807, 0x9eea9f4e, 0x186cc023, 
0x44c586d4, 0xcbbada42, 0x5f77c61e, 0xae3186b4, 0xd0cd3648, 0x5fe04536, 0x1fe33781, 0x43382e09, 
0x30feee3c, 0x5e175538, 0xe56f78b6, 0x2bb04265, 0x2f252134, 0x2af525c7, 0xfcc63cd5, 0x396ec998, 
0x7206ce83, 0x1f4ed4b0, 0x0861a648, 0xbc0a44c5, 0x0d2ae600, 0xd826ba63, 0x4068ddd3, 0xea1903d5, 
0xf06e038e, 0x646beada, 0x051a6c9e, 0x31496314, 0x3d579ba6, 0xed45572e, 0x493ef8a1, 0x1cfa95f3, 
0xef2daf9a, 0x34fc5bbd, 0x1f1391f1, 0xe96724c4, 0xb3675f41, 0xcd87169b, 0x60e06acd, 0x1f2c6d20, 
0x2c5fcbd4, 0x768e0de1, 0xe4f58bbe, 0xb45ccb73, 0x3a418edf, 0x3c89cd27, 0x20ca6072, 0x6466d0d1, 
0x19f490b8, 0xf01c0ee2, 0x1ab325ab, 0xe125276e, 0x319d8630, 0x32c18190, 0xe9e74e99, 0x02d3e2fa, 
0x7b702d3a, 0x0904dd66, 0x0adc0ca8, 0x59cd89dc, 0x6c57cace, 0xa93332fd, 0x530f7e9d, 0xa58a144a, 
0x91e9c968, 0x772d8c33, 0x21699d6d, 0x7e46b62f, 0xb3af6fe4, 0x8e39a9eb, 0x19393842, 0xcd85ebf5, 
0xba1e2ff9, 0x3c0d8465, 0x3655ac02, 0x9d57f0ff, 0x44da401d, 0xca422d09, 0x8eed96fa, 0x4dfbfddd, 
0x49343083, 0x328963d4, 0xaceec13f, 0xe9bf1c2c, 0xc754429f, 0xdab8520f, 0x45c7df63, 0x08b93189, 
0x88505e3a, 0xdf8a9f9f, 0x7a3401b1, 0x75177227, 0x8555064f, 0xb3065581, 0xe6b73da3, 0xfd047573, 
0xfe3c951b, 0x29141e06, 0x6f2b0796, 0x59a3215f, 0xc0f6dad2, 0x3df71960, 0x48b19ecd, 0x31881da4, 
0xa870201c, 0xc53c8d19, 0x47c534fd, 0xdffdc685, 0x913904a4, 0x00302b22, 0xb340a12e, 0x0bc01a7d, 
0xc10b17dc, 0xd2ead50f, 0x18e7368f, 0xa64267df, 0xe0b5629d, 0x185ad645, 0x761edb72, 0xc40779a9, 
0x3aeeb2f1, 0x43b311e9, 0xfcb275c6, 0xdf1b877d, 0x16517042, 0x1c5423e0, 0x925ae1ad, 0xa24d451e, 
0xfe079185, 0x92639756, 0xd8f70326, 0xd6c343f3, 0x4fc37907, 0x5752d3d0, 0xffbdb114, 0x3534bad2, 
0x76338e03, 0x2a63806e, 0x80f9dd43, 0x9275f74e, 0x7cb2decd, 0x977b357d, 0x1c55340c, 0x88790d05, 
0xd35491c2, 0x31aca52e, 0x0df539f8, 0x39471eb0, 0xa14bc771, 0x88afeb59, 0x9a999a08, 0x49b5bc1b, 
0x45c7c2fe, 0x4d1bef86, 0x714d6790, 0x6f61f35b, 0xe084c888, 0xd3ed9fcf, 0x7af778e7, 0x3b182e42, 
0xbf9a0031, 0x7c6d0275, 0x55c92ed4, 0x4b37362f, 0x66b04f48, 0xeb0697e7, 0x065ac667, 0x5f5e8739, 
0xd97b57e1, 0x75168d09, 0x47bda149, 0x85d62b79, 0xaae428e6, 0x50cd3e76, 0x2aebaafa, 0x237e2ac1, 
0xb7bdb125, 0x486910b9, 0x5fb670fc, 0x99821121, 0xfc53f54c, 0x3b688cc2, 0xace9576e, 0xcf577033, 
0x69fbbbf5, 0x311476c5, 0x88da47d4, 0xf1e10962, 0xcfd5a371, 0x1847b210, 0xa5ce4f69, 0x36140772, 
0xaed28771, 0x81bffd11, 0x781fd509, 0x3ca75e44, 0xfd172850, 0x20604f18, 0x86f16bd5, 0xc4c3e545, 
0x39005850, 0x62086906, 0xcde4466b, 0xfe8b5757, 0x12dde9d3, 0x300e4466, 0x25572aae, 0x5b2a1bb4, 
0x13221c13, 0x57f23af6, 0xfc6c110d, 0x8dadc2ce, 0x2b71c5e3, 0xddb149a1, 0x9fad3c5b, 0xdef63cd0, 
0xfad11c77, 0x12608156, 0x6e39d068, 0x884aa45f, 0xeaf3435c, 0xc5139ada, 0x20ce7c7c, 0xbc5631d9, 
0x6c9d5274, 0xfecbebf4, 0x720a307e, 0xe1600aa6, 0xe980fa9b, 0xc7ed0b1f, 0xa775ad4f, 0x344716bb, 
0x10a4e95c, 0x8c3b125e, 0x82030115, 0x0ab43441, 0x788c1c2d, 0x3ace232f, 0xaa3b98d6, 0xad88b0c5, 
0xa835943f, 0xb982c5c4, 0xdb887bda, 0x4866e165, 0x227da3d9, 0x1bad3711, 0x035321e1, 0x7b7cc50c, 
0x9edee2fc, 0xe8cd3ece, 0x33524db8, 0x19f94173, 0x8ed4c60e, 0x774b10c6, 0xc560323a, 0x3a8aae96, 
0xe00966b0, 0xc67d634f, 0xeefe9a8c, 0xccbc3414, 0x9e2c2f4b, 0xbb0cf510, 0x57518c8a, 0xd5c5e362, 
0x4b48f6eb, 0x2954daf3, 0x7ac48cd7, 0xb6a06b70, 0x2d5b1271, 0x9308ae1b, 0x3cdf448a, 0x26355f4c, 
0x745a9d9d, 0xb17b4fc0, 0x1157f891, 0x8b5f801a, 0x7fc61ff3, 0xc9002507, 0xfc8ceca7, 0x46198e46, 
0x253b31e3, 0x4da4ef12, 0xb22c2a4e, 0x030d4b7f, 0xb9cb0a86, 0xda153bff, 0x5653aa15, 0x8d76cd20, 
0xf9fbe2fa, 0xa2ce0afd, 0x3ac63d1c, 0xd4762624, 0xa433f567, 0x3fa40290, 0xe4daf9dd, 0xd1de41f1, 
0x9f68c4fb, 0x132ab598, 0x4ab019c7, 0x591299ea, 0x67e56ef5, 0xa26d6d72, 0x53903968, 0x18c39c52, 
0xba9120a0, 0xba857eba, 0xae78a59b, 0x32cf660e, 0x964a0e75, 0x738c11f4, 0xa1a8c970, 0x93860b44, 
0x85a6a6d9, 0x554b6139, 0x75370304, 0x7fffffff };

void    CA_HashKey ( unsigned char * pbHashValue, long lHashLen, unsigned char * pData, long lDataLen )
{
    unsigned char * pInternalBase;
    unsigned char bValue;
    long lIndexData;
    long lIndexBase;
    long lIndexHash;
    unsigned char bSHA512[64];

    pInternalBase = (unsigned char *)__CA_Hash_InternalBaseData;
    memcpy ( pbHashValue, pInternalBase, lHashLen );
    
    //Création du SHA512
    CA_sha512 ( pData, lDataLen, bSHA512 );
    
    lIndexBase = (((unsigned long *)bSHA512)[0])&4095;
    for (lIndexHash=0;lIndexHash<lHashLen;lIndexHash++)
    {
        pbHashValue[lIndexHash] = bSHA512[lIndexHash&63];
    }
    
    for (lIndexData=0;lIndexData<lDataLen;lIndexData++)
    {
        bValue      = pData[lIndexData];        
        for (lIndexHash=0;lIndexHash<lHashLen;lIndexHash++)
        {
            pbHashValue[lIndexHash] = ( pbHashValue[lIndexHash] ^ bValue ) + pInternalBase[lIndexBase];
            lIndexBase  = (lIndexBase+bValue)&4095;
            bValue = (bValue>>1) + ((bValue&1)<<7);
        }
    }
    
    //On XOR la sortie
    for (lIndexHash=0;lIndexHash<lHashLen;lIndexHash++)
    {
        pbHashValue[lIndexHash] ^= bSHA512[lHashLen&63];    
    }
}

